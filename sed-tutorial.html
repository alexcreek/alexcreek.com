<!DOCTYPE html>
<html lang="en">
<head>
          <title>War Against Computers</title>
        <meta charset="utf-8" />
        <link href="alexcreek.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="War Against Computers Full Atom Feed" />
        <link href="alexcreek.com/feeds/code.atom.xml" type="application/atom+xml" rel="alternate" title="War Against Computers Categories Atom Feed" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="../../favicon.ico">





    <!-- Google web fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,900' rel='stylesheet' type='text/css'>

    <!-- Bootstrap core CSS -->
    <link href="./theme/css/bootstrap.min.css" rel="stylesheet"> 

    <!-- Custom styles for this template -->
    <link href="./theme/css/starter-template.css" rel="stylesheet"> 
    
    <!-- Search CSS -->
    <link rel="stylesheet" href="./theme/tipuesearch/tipuesearch.css"> 
</head>

 <body>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>
                    <li class="active"><a href="./category/code.html">Code</a></li>
                    <li><a href="./category/networking.html">Networking</a></li>
                    <li><a href="./category/system-administration.html">System Administration</a></li>
          </ul>
<!--                <form id="searchform" action="/search.html" onsubmit="return (this.elements['q'].value.length > 0)">
                    <div class="form-group">
                        <input class="form-control" id="searchbox" type="text" name="q" size="12" placeholder="Search">
                    </div>
                </form> -->
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">
<body id="index" class="home">
        <header id="banner" class="body">
                <h1 class="header"><a href="./">War Against Computers <strong></strong></a></h1>
        </header><!-- /#banner -->

<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="./sed-tutorial.html" rel="bookmark"
         title="Permalink to Sed Tutorial">Sed Tutorial</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2014-10-02T00:00:00-04:00">
      Thu 02 October 2014
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="./author/alex.html">alex</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Sed's primary function is to search for and replace text; we call this process "substitution".  Additionally, sed can easily append, insert and delete text.  The syntax can be somewhat intimidating to the new user.</p>
<div class="highlight"><pre>sed &#39;command/pattern/replacement/flags&#39; file.txt
sed &#39;\pattern\|line_number command/input_text/&#39; file.txt
</pre></div>


<p>The command field tells sed what to do when a match is found; the pattern field is the search string; the replacement field should be obvious and the flag defines various options such as how many times to act on a search hit.  The tricky part lies in the fact that sed has multiple syntaxes.  When performing operations on entire lines the command field is prefixed with the target line number(s) and the pattern field is not used. </p>
<h2>Typical Use</h2>
<div class="highlight"><pre>sed -i &#39;s/herf/href/g&#39; /var/www/index.html 
</pre></div>


<p>The example replaces all instances of herf with href, pretty slick huh?  Let's take a look at some of the other things Sed can do.</p>
<h2>Substitution</h2>
<p>We just saw this in the last example. Here we replace all instances of foo with bar</p>
<div class="highlight"><pre>sed -i &#39;s/foo/bar/g&#39; file.txt
</pre></div>


<h2>Deletion</h2>
<p>Sed can also delete specific lines of text. The following removes line 10 from file.txt</p>
<div class="highlight"><pre>sed -i &#39;10d&#39; file.txt
</pre></div>


<h2>Range Deletion</h2>
<p>A range of lines can be deleted at once using D. The example deletes line 95-10.</p>
<div class="highlight"><pre>sed -i &#39;95,100D&#39; file.txt
</pre></div>


<h2>Append</h2>
<p>Strings can be appended after a specific line. This example appends Bazinga to a new line after line 20</p>
<div class="highlight"><pre>sed -i &#39;20a\Bazinga\&#39; file.txt
</pre></div>


<h2>Insertion</h2>
<p>Sed can insert text before specifed lines as well. Here we insert Incoming into line 20 thus moving line 20's contents to line 21</p>
<div class="highlight"><pre>sed -i &#39;20i\Incoming\&#39; file.txt
</pre></div>


<h2>Replacement</h2>
<p>Sed can also performs replacement of entire lines. Using the c command replaces the entire line with the specified string.</p>
<div class="highlight"><pre>sed -i &#39;10c\Presto\&#39; file.txt
</pre></div>


<h2>Pattern Match Deletion</h2>
<p>Another deletion feature of Sed's is deleting lines that matches a pattern. The example deletes every line that contains the string false</p>
<div class="highlight"><pre>sed -i &#39;/false/d&#39;  file.txt
</pre></div>


<p></br></p>
<h1>Advanced Sed</h1>
<h2>Sed's additional syntax (insert, append, delete, and replace):</h2>
<div class="highlight"><pre>sed /pattern/|line number i\ a\ d\ c\input_text\ filename
</pre></div>


<h2>Find a string and delete the line it's in</h2>
<div class="highlight"><pre>sed -i &#39;/error/d/&#39; /var/log/tunnel.log
</pre></div>


<ul>
<li>/d deletes a line that matches the pattern, it's part of sed's bizarre syntax</li>
</ul>
<h2>Find a string and insert stuff into the line before it</h2>
<div class="highlight"><pre>sed -i &#39;/^exit/ i\iptables-restore &lt; /etc/firewall.rules\&#39; /etc/rc.local
</pre></div>


<ul>
<li>The additional syntax accepts line numbers and ranges, but matching regexes is much cleaner</li>
</ul>
<h2>Find a string and replace the entire line</h2>
<div class="highlight"><pre>sed -i &quot;s/^dc_relay_net.*$/dc_relay_net=&#39;$IP&#39;/&quot; /etc/exim4/update-exim4.conf.conf
</pre></div>


<ul>
<li>-i actions are performed inline, directly within the file specified</li>
<li>" " are used so $IP will expand AND it's contents will be surrounded by ' ' when finished</li>
<li>The entire line gets replaced because of creative use of regex matching</li>
<li>^ matches the beginning of a line, .* matches everything, $ matches the end of a line, duh</li>
<li>sed -i "/dc_relay_net/ c\dc_relay_net='$IP'/" would work except the " "s mess up the command and they're needed due to using $IP</li>
</ul>
  </div><!-- /.entry-content -->
</section>
    </div>

<script type="text/javascript">
    var disqus_shortname = 'alexcreekcom';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
        
        <footer id="contentinfo" class="container">
                <address id="about" class="vcard body">
                </br>Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="./theme/js/bootstrap.min.js"></script>
    
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
	var pageTracker = _gat._getTracker("UA-56063544-1");
pageTracker._trackPageview();
} catch(err) {}</script>

    
</body>
</html>
